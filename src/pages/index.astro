---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import DividerDashed from "@/components/DividerDashed.astro";
import Section from "@/components/Section.astro";
import Subheading from "@/components/Subheading.astro";
import Subtext from "@/components/Subtext.astro";
import ContactDetails from "@/components/ContactDetails.astro";
import ProjectDetails from "@/components/ProjectDetails.astro";
import PostLinks from "@/components/PostLinks.astro";
import TalkLinks from "@/components/TalkLinks.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("writing");
const sortedPosts = posts
    .map((post) => ({
        slug: post.id,
        title: post.data.title,
        date: post.data.date,
        keywords: post.data.keywords || [],
    }))
    .sort((a, b) => {
        if (a.date && b.date) {
            return b.date.getTime() - a.date.getTime();
        }
        return a.date ? -1 : b.date ? 1 : 0;
    });
const latestPosts = sortedPosts.slice(0, 5);
---

<Layout>
    <Header />
    <DividerDashed class="my-4" />

    <Section>
        <p>
            Creating high-performance and maintainable digital products. Rescuing legacy, unloved and underperforming
            systems. Rapidly prototyping new ideas and MVPs.{" "}
            <span class="font-bold">Advocating for open-source, privacy-oriented software.</span>
        </p>
    </Section>

    <Section>
        <div class="flex items-center justify-between gap-2">
            <Subheading>Open-source projects</Subheading>
            <a href="/projects" class="text-white hover:text-[#F7AC3A] text-lg">â†’</a>
        </div>
        <Subtext>It feels good to scratch your own itch.</Subtext>
        <ProjectDetails
            class="pt-6"
            items={[
                {
                    title: "django-nitro-mailer",
                    description: "ðŸ“¨ Django mails. Supercharged.",
                    href: "https://github.com/majikode/django-nitro-mailer",
                },
                {
                    title: "CILISSA",
                    description: "ðŸ–¼ï¸ Interactive tool for assessing digital image similarity",
                    href: "https://github.com/exler/CILISSA",
                },
                {
                    title: "fileigloo",
                    description: "â„ï¸ Small and simple online file sharing & pastebin",
                    href: "https://github.com/exler/fileigloo",
                },
                {
                    title: "yt-transcribe",
                    description: "âœï¸ Transcribe YouTube videos using AI speech recognition ",
                    href: "https://github.com/exler/yt-transcribe",
                },
                {
                    title: "Placemarker",
                    description: "ðŸ“ World map to track the countries you've been to ",
                    href: "https://github.com/exler/placemarker",
                },
            ]}
        />
    </Section>

    <Section>
        <div class="flex items-center justify-between gap-2">
            <Subheading>Writing</Subheading>
            <a href="/writing" class="text-white hover:text-[#F7AC3A] text-lg">â†’</a>
        </div>
        <Subtext>
            Scribbles and thoughts of mine, mostly on the topics of software, self-hosting, privacy and productivity.
        </Subtext>
        <PostLinks items={latestPosts} class="pt-6" />
    </Section>

    <Section>
        <Subheading>Talks</Subheading>
        <Subtext>Watch me gesticulate a lot.</Subtext>
        <TalkLinks
            items={[
                {
                    title: "Achieving Zero-Downtime Migrations in High-Traffic Django Systems",
                    event: "Django Vienna 06-2025",
                    date: new Date("2025-06-11"),
                    slidesLink: "https://talks.kamilmarut.com/2025-django-vienna/",
                },
                {
                    title: "Demystifying Python Modules and Imports: How Imports Really Work in Python",
                    event: "PyCon Austria 2025",
                    date: new Date("2025-04-06"),
                    slidesLink: "https://talks.kamilmarut.com/2025-pycon-austria/",
                    videoLink: "https://youtu.be/qQQT88mpmms",
                },
            ]}
            class="pt-6"
        />
    </Section>

    <Section>
        <Subheading>Stay in touch</Subheading>
        <Subtext>I'm always open to interesting freelancing/consulting offers!</Subtext>
        <ContactDetails
            class="pt-6"
            items={[
                {
                    title: "Email",
                    href: "mailto:kamil@kamilmarut.com",
                    text: "kamil@kamilmarut.com",
                },
                {
                    title: "GitHub",
                    href: "https://github.com/exler",
                    text: "github.com/exler",
                },
                {
                    title: "LinkedIn",
                    href: "https://www.linkedin.com/in/kamilmarut/",
                    text: "linkedin.com/in/kamilmarut",
                },
                {
                    title: "Resume",
                    href: "/resume",
                    text: "HTML",
                },
            ]}
        />
    </Section>
</Layout>
